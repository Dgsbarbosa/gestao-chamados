<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Chamados</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h1>Lista de Chamados</h1>

  <div class="filtros">
    <input id="filtro-cidade" placeholder="Filtrar por cidade" oninput="filtrarChamados()">
    <input id="filtro-status" placeholder="Filtrar por status" oninput="filtrarChamados()">
  </div>

  <table id="tabela-chamados">
    <thead>
      <tr>
        <th>ID</th>
        <th>TÃ­tulo</th>
        <th>Status</th>
        <th>Cidade</th>
        <th>Executado por</th>
        <th>Data</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script src="script.js"></script>
  <script>
    let chamados = [];

    async function carregarChamados() {
      try {
        const response = await fetch(`${BASE_URL}?sheet=chamados`);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        chamados = await response.json();
        exibirChamados(chamados);
      } catch (error) {
        console.error("Erro ao carregar chamados:", error);
        alert("Erro ao carregar chamados. Por favor, tente novamente.");
      }
    }

    function exibirChamados(lista) {
      const tbody = document.querySelector('tbody');
      tbody.innerHTML = '';
      lista.forEach(ch => {
        tbody.innerHTML += `
          <tr>
            <td><span class="math-inline">\{ch\.Codigo\}</td\>
<td\></span>{ch["Descricao do Servico"]}</td>
            <td><span class="math-inline">\{ch\.Status\}</td\>
<td\></span>{ch.Polo}</td>
            <td><span class="math-inline">\{ch\["Executado por"\]\}</td\>
<td\></span>{ch.Data}</td>
          </tr>
        `;

      });
    }

    function filtrarChamados() {
      const cidade = document.getElementById('filtro-cidade').value.toLowerCase();
      const status = document.getElementById('filtro-status').value.toLowerCase();
      const filtrados = chamados.filter(ch =>
        ch.Polo.toLowerCase().includes(cidade) &&
        ch.Status.toLowerCase().includes(status)
      );
      exibirChamados(filtrados);
    }

    carregarChamados();
  </script>
</body>

</html>